<%-include("../layout/user/header")-%>
<%-include("../partials/usernav")-%> 


<div class="container">
    <form action="/confirmAddress" method="post">
      <div class="row d-flex">
        <div class="col-12 col-md-8">
          <div class="card border shadow mt-5">

            <div class="m-4">
              <div class="col-12 d-flex rounded-lg justify-content-center" style="background-color:black; color:white;">
                <h4 class="card-title mb-4 mt-4 ">Select Address</h4>
              </div>
              <!-- start for each ------------------------- -->
              <% address.forEach(x => { %>
               
             
             
                <br>
                <div class="form-check border shadow px-5 py-5">
                  <input class="form-check-input" type="radio" name="adressId" value='<%-x._id-%>' id="flexRadioDefault1"
                    checked>
                  <label class="form-check-label text-dark" for="flexRadioDefault1" style="font-size: small;">
                    <%=x.name%>,
                    <%=x.mobile%> <br>
                      <%=x.address%>,<%=x.locality%>,<br>
                          <%=x.city%>,<%=x.district%>,<%=x.state%>,<br>
                                <%=x.pincode%>
                  </label>
                </div>
                <% }) %>
                <!-- end for each -------------------------- -->
            </div>
            <!-- <div class="d-flex justify-content-end"><a class="btn btn-primary m-3" href="/getAddUserAddress">Add
                Address</a>
            </div> -->
            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-primary m-3" style="width: 20%;" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@getbootstrap">add address</button>
            </div>
           
        

            
       
          </div>
        </div>
        <div class="col-12 col-md-4">
          <div class="card border shadow mt-5">
            <div class="card-body">
              <h5 class="card-title">Have You coupon ?</h5>
              <span class="bg-danger text-white" role="alert" id="errrorShow"></span>
              <div class="input-group mb-3">
                <!-- if coupen code---------------------------------------------------- -->
               
                  <input type="text" class="form-control border" placeholder="Coupon Code" aria-label="coupon"
                    id="coupon" aria-describedby="button-addon2" value="coupencode " />
                  <!--      -->
                    <input type="text" class="form-control border" placeholder="Coupon Code" aria-label="coupon"
                      id="coupon" aria-describedby="button-addon2" />
                  <!--       -->
                      <button class="btn btn-primary border shadow-0" onclick="checkCoupon()" type="button"
                        id="button-addon2" data-mdb-ripple-color="dark">
                        Apply
                      </button>
                      <!-- ifcoupen code----------------------------------------------------- -->
              </div>
            </div>
          </div>
          <div class="card shadow border mt-3">
            <div class="card-body">
              <div id="subtotal" class="d-flex justify-content-between">
                <p class="mb-2"><b>Subtotal :</b></p>
                <b>
                  <p>Rs.<%= subtotel%><span id="subtotalAmount">
                      </span></p>
                </b>
              </div>
              <div class="d-flex justify-content-between">
                <p class="mb-2"><b>Coupon(Discount) :</b></p>
             <!-- if coupe ------------------- -->
                  <!-- <b> -->
                    <!-- <p>Rs.0 <span id="discountAmount"> -->
                       <!-- coupen  -->
                      <!-- </span></p> -->
                  <!-- </b> -->
                <!-- eklse  if----------------- -->
                    <b>
                      <p>Rs.0<span id="discountAmount">

                        </span></p>
                    </b>
                <!-- end ------------------------------ -->
              </div>
              <hr />
              <div class="d-flex justify-content-between">
                <p class="mb-2"><b>Total price :</p>
                <h5 class="mb-2" style="color: rgb(47, 129, 207);"><span id="totalPrice">
                   
                          Rs. <%- subtotel-%>
                  </span></h5>
               

                  </b>
              </div>
            </div>
          </div>



          <div class="card shadow border p-3 mt-3">
            <!-- Check if address length is less than 0 -->
            <h5 class="text-success"><b>Choose Payment Method</b></h5>
        
            <!-- Payment options -->
            <div>
                <input type="radio" name="paymethod" id="onlinepayment" value="online" class="p-2" checked >
                <label for="onlinepayment"><b>Online Payment</b></label><br>
        
                <input type="radio" name="paymethod" id="codpayment" value="cod" class="p-2">
                <label for="codpayment"><b>Cash On Delivery (COD)</b></label><br>
        
                <input type="radio" name="paymethod" id="walletpayment" value="wallet" class="p-2">
                <label for="walletpayment"><b>Wallet Payment</b></label><br>


                <button type="submit" class="btn btn-primary m-3 float-end">Place Order</button>
            </div>
        
            <!-- Alternative content if address length is 0 -->
            <!--
            <h5 class="text-danger"><b>Please add an address</b></h5>
            -->
        
            <!-- End of content -->
        </div>  
          

        </div>
      </div>
  </div>
  </form>

<!-- modal       -------------------------------------------  -->








  <!-- <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-dark text-white">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Add Address </h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form class="p-5" method="post" action="/addaddress">
            <div class="container">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Name:</label>
                    <input type="text" class="form-control" name="name" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Phone no:</label>
                    <input type="number" class="form-control"   name="mobile" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Email:</label>
                    <input type="email" class="form-control" name="email" id="recipient-name">
                  </div>
              </div>
            
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Pincode:</label>
                    <input type="text" class="form-control" name="pincode" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Locality:</label>
                    <input type="text" class="form-control" name="locality" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">City:</label>
                    <input type="text" class="form-control" name="city" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">District:</label>
                    <input type="text" class="form-control" name="district" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">state:</label>
                    <input type="text" class="form-control" name="state" id="recipient-name">
                  </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                    <label for="message-text" class="col-form-label">Address:</label>
              <textarea class="form-control" id="message-text" name="address" placeholder="house name,post office"></textarea>
                  </div>
              </div>
            </div>
        </div>
           
         
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary">Submit</button>
        </div>
    </form>
      </div>
    </div>
  </div> -->

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-dark text-white">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Add Address</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form class="p-5" method="post" action="/addaddress" id="addressForm">
            <div class="container">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Name:</label>
                    <input type="text" class="form-control" name="name" id="recipient-name" required>
                    <small class="text-danger" id="nameError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-phone" class="col-form-label">Phone no:</label>
                    <input type="number" class="form-control" name="mobile" id="recipient-phone" required>
                    <small class="text-danger" id="phoneError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-email" class="col-form-label">Email:</label>
                    <input type="email" class="form-control" name="email" id="recipient-email" required>
                    <small class="text-danger" id="emailError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-pincode" class="col-form-label">Pincode:</label>
                    <input type="text" class="form-control" name="pincode" id="recipient-pincode" required>
                    <small class="text-danger" id="pincodeError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-locality" class="col-form-label">Locality:</label>
                    <input type="text" class="form-control" name="locality" id="recipient-locality" required>
                    <small class="text-danger" id="localityError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-city" class="col-form-label">City:</label>
                    <input type="text" class="form-control" name="city" id="recipient-city" required>
                    <small class="text-danger" id="cityError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-district" class="col-form-label">District:</label>
                    <input type="text" class="form-control" name="district" id="recipient-district" required>
                    <small class="text-danger" id="districtError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="recipient-state" class="col-form-label">State:</label>
                    <input type="text" class="form-control" name="state" id="recipient-state" required>
                    <small class="text-danger" id="stateError"></small>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">Address:</label>
                    <textarea class="form-control" id="message-text" name="address" placeholder="house name, post office" required></textarea>
                    <small class="text-danger" id="addressError"></small>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="submitBtn" disabled>Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Bootstrap 5.2 JS libraries -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"></script>
  
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("addressForm");
      const submitButton = document.getElementById("submitBtn");
  
      submitButton.disabled = true;
  
      form.addEventListener("input", function (event) {
        const input = event.target;
        const errorElement = document.getElementById(`${input.name}Error`);
  
        const value = input.value.trim();
  
        if (/^[a-zA-Z0-9].*$/.test(value) && !value.startsWith(' ')) {
          errorElement.textContent = ''; // Clear error message
        } else {
          errorElement.textContent = 'Must start with a number or letter and cannot start with a space';
        }
  
        // Check all input fields for validation
        const inputs = form.querySelectorAll("input[type='text'], input[type='number'], input[type='email'], textarea");
        const isValid = Array.from(inputs).every(input => {
          const value = input.value.trim();
          return /^[a-zA-Z0-9].*$/.test(value) && !value.startsWith(' ');
        });
  
        submitButton.disabled = !isValid;
      });
    });
  </script>
<!-- end ---------------------------------------------------- -->

  <!-- footer start ------------ -->
<%-include("../partials/footernav")-%>
<!-- footer end ------------ -->
<%-include("../layout/user/footer")-%>